'''
$Id: pix2tes.py
$auth: Steve Torchinsky <satorchi@apc.in2p3.fr>
$created: Fri 21 Jul 2017 08:26:39 CEST
$license: GPLv3 or later, see https://www.gnu.org/licenses/gpl-3.0.txt

          This is free software: you are free to change and
          redistribute it.  There is NO WARRANTY, to the extent
          permitted by law.

translate the TES number to the physical location on focal plane grid
'''

def assign_TES_grid(self):
    '''
    generate the layout of the TES array
    zeros indicate empty grid positions
    '''
    ncols=[8,9,11,12,12,14,15,15,16,17,17,17,17,17,17,17,17]
    rows=[]
    prev_row_end=0
    for N in ncols:
        row=np.arange(N)+prev_row_end+1
        rows.append(row)
        prev_row_end=row[-1]

    full_grid=np.zeros((17,17), dtype=int)
    nrow=0
    for row in rows:
        Ntes=len(row)
        full_grid[nrow,0:Ntes]=row
        nrow+=1

    self.TESgrid=full_grid
    return full_grid

def assign_pix2tes(self):
    pix2tes=[]
    pix2tes.append([\
                [1,125],\
                [2,126],\
                [3,127],\
                [4,128],\
                [5,121],\
                [6,122],\
                [7,123],\
                [8,124],\
                [9,117],\
                [10,118],\
                [11,119],\
                [12,120],\
                [13,113],\
                [14,114],\
                [15,115],\
                [16,116],\
                [17,109],\
                [18,110],\
                [19,111],\
                [20,112],\
                [21,105],\
                [22,106],\
                [23,107],\
                [24,108],\
                [25,101],\
                [26,102],\
                [27,103],\
                [28,104],\
                [29,97],\
                [30,98],\
                [31,99],\
                [32,100],\
                [33,93],\
                [34,94],\
                [35,95],\
                [36,96],\
                [37,89],\
                [38,90],\
                [39,91],\
                [40,92],\
                [41,85],\
                [42,86],\
                [43,87],\
                [44,88],\
                [45,81],\
                [46,82],\
                [47,83],\
                [48,84],\
                [49,77],\
                [50,78],\
                [51,79],\
                [52,80],\
                [53,73],\
                [54,74],\
                [55,75],\
                [56,76],\
                [57,69],\
                [58,70],\
                [59,71],\
                [60,72],\
                [61,65],\
                [62,66],\
                [63,67],\
                [64,68],\
                [65,61],\
                [66,62],\
                [67,63],\
                [68,64],\
                [69,57],\
                [70,58],\
                [71,59],\
                [72,60],\
                [73,53],\
                [74,54],\
                [75,55],\
                [76,56],\
                [77,49],\
                [78,50],\
                [79,51],\
                [80,52],\
                [81,45],\
                [82,46],\
                [83,47],\
                [84,48],\
                [85,41],\
                [86,42],\
                [87,43],\
                [88,44],\
                [89,37],\
                [90,38],\
                [91,39],\
                [92,40],\
                [93,33],\
                [94,34],\
                [95,35],\
                [96,36],\
                [97,29],\
                [98,30],\
                [99,31],\
                [100,32],\
                [101,25],\
                [102,26],\
                [103,27],\
                [104,28],\
                [105,21],\
                [106,22],\
                [107,23],\
                [108,24],\
                [109,17],\
                [110,18],\
                [111,19],\
                [112,20],\
                [113,13],\
                [114,14],\
                [115,15],\
                [116,16],\
                [117,9],\
                [118,10],\
                [119,11],\
                [120,12],\
                [121,5],\
                [122,6],\
                [123,7],\
                [124,8],\
                [125,1],\
                [126,2],\
                [127,3],\
                [128,4]\
    ]
    )

    pix2tes.append([\
                [1,29],\
                [2,30],\
                [3,31],\
                [4,32],\
                [5,25],\
                [6,26],\
                [7,27],\
                [8,28],\
                [9,21],\
                [10,22],\
                [11,23],\
                [12,24],\
                [13,17],\
                [14,18],\
                [15,19],\
                [16,20],\
                [17,13],\
                [18,14],\
                [19,15],\
                [20,16],\
                [21,9],\
                [22,10],\
                [23,11],\
                [24,12],\
                [25,5],\
                [26,6],\
                [27,7],\
                [28,8],\
                [29,1],\
                [30,2],\
                [31,3],\
                [32,4],\
                [33,61],\
                [34,62],\
                [35,63],\
                [36,64],\
                [37,57],\
                [38,58],\
                [39,59],\
                [40,60],\
                [41,53],\
                [42,54],\
                [43,55],\
                [44,56],\
                [45,49],\
                [46,50],\
                [47,51],\
                [48,52],\
                [49,45],\
                [50,46],\
                [51,47],\
                [52,48],\
                [53,41],\
                [54,42],\
                [55,43],\
                [56,44],\
                [57,37],\
                [58,38],\
                [59,39],\
                [60,40],\
                [61,33],\
                [62,34],\
                [63,35],\
                [64,36],\
                [65,93],\
                [66,94],\
                [67,95],\
                [68,96],\
                [69,89],\
                [70,90],\
                [71,91],\
                [72,92],\
                [73,85],\
                [74,86],\
                [75,87],\
                [76,88],\
                [77,81],\
                [78,82],\
                [79,83],\
                [80,84],\
                [81,77],\
                [82,78],\
                [83,79],\
                [84,80],\
                [85,73],\
                [86,74],\
                [87,75],\
                [88,76],\
                [89,69],\
                [90,70],\
                [91,71],\
                [92,72],\
                [93,65],\
                [94,66],\
                [95,67],\
                [96,68],\
                [97,125],\
                [98,126],\
                [99,127],\
                [100,128],\
                [101,121],\
                [102,122],\
                [103,123],\
                [104,124],\
                [105,117],\
                [106,118],\
                [107,119],\
                [108,120],\
                [109,113],\
                [110,114],\
                [111,115],\
                [112,116],\
                [113,109],\
                [114,110],\
                [115,111],\
                [116,112],\
                [117,105],\
                [118,106],\
                [119,107],\
                [120,108],\
                [121,101],\
                [122,102],\
                [123,103],\
                [124,104],\
                [125,97],\
                [126,98],\
                [127,99],\
                [128,100]\
    ]
    )

    self.pix2tes=pix2tes
    return
